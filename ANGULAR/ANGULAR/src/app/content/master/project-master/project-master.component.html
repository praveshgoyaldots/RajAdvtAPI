

<app-global-list-search [SearchFields]="ViewdisplayedColumns" (onSearch)="SearchByKeyword($event)">
</app-global-list-search>
<div class="row">
  <div class="col l12 s12">
    	<div class="row m-20 mb-0">
          <div class="col l4 xl4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label>From Date</mat-label>
              <input matInput [matDatepicker]="picker2" (focus)="picker2.open()" readonly placeholder="Date" [(ngModel)]="indexModel.FromDate" [max]="indexModel.ToDate">
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="col l4 xl4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label>To Date</mat-label>
              <input matInput [matDatepicker]="picker1" (focus)="picker1.open()" readonly placeholder="Date" [(ngModel)]="indexModel.ToDate" [min]="indexModel.FromDate">
              <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
              <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="col l4 xl4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label>Admin Department</mat-label>
              <mat-select [(ngModel)]="indexModel.AdmDepartmentCode" (selectionChange)="getDepartmentByadmDepartment($event.value)">
                <mat-option value="{{ k.Value }}" *ngFor="let k of dDLList?.ddlUserAdminDepartment">{{ k.Text }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col l4 xl4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label>Nodal Department</mat-label>
              <mat-select [(ngModel)]="indexModel.NodalDepartmentCode" (selectionChange)="GetProjectSchemeCategoryByDepartment($event.value)">
                <mat-option value="{{ k.Value }}" *ngFor="let k of ddlDepartment">{{ k.Text }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col l4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label> Project/Scheme/Program Name(By Department)</mat-label>
              <mat-select [(ngModel)]="indexModel.ProjectSchemeCode" multiple>

                <mat-option value="{{ k.Code }}" *ngFor="let k of ddlProjectSchemeCategory">{{ k.ProgramSchemeName }}/({{k.ProgramSchemeTypeName}}) </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col l4 xl4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label>District</mat-label>
              <mat-select [(ngModel)]="indexModel.DistrictCode" (selectionChange)="getMLAByDisctrictCode($event.value)" multiple>
                <!-- <mat-option value="{{ k.Value }}" *ngFor="let k of dDLList?.ddlDistrict">{{k.Text}}</mat-option> -->
                <mat-option value="{{k.Value}}" *ngFor="let k of  ddlDistrict">{{k.Text}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col l4 xl4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label>MLA Constituency</mat-label>
              <mat-select [(ngModel)]="indexModel.MLACode" multiple>
                <mat-option value="{{ k.Value }}" *ngFor="let k of ddlMLAConstituency">{{k.Text}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col l4 xl4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label>Category</mat-label>
              <mat-select [(ngModel)]="indexModel.CategoryCode">
                <mat-option value="{{ k.Value }}" *ngFor="let k of dDLList?.ddlProjectCategory">{{k.Text}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col l4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label>Sub Category </mat-label>
              <mat-select [(ngModel)]="indexModel.SubCategoryCode">

                <mat-option value="{{item.Value}}" *ngFor="let item of dDLList?.ddlProjectSubCategory">{{item.Text}} </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col l4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label> Work Type </mat-label>
              <mat-select [(ngModel)]="indexModel.SubSubCategoryCode">
                  <mat-option >--Select--</mat-option>
                <mat-option value="{{item.Value}}" *ngFor="let item of dDLList?.ddlProjectSubSubCategory">{{item.Text}} </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col l4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label> Works Entry Status</mat-label>
              <mat-select [(ngModel)]="indexModel.ProjectStatusCode">
                <mat-option value="{{item.Value}}" *ngFor="let item of dDLList?.ddlProjectStatus">{{item.Text}} </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col l4 m6 s12">
            <mat-form-field class="example-full-width" appearance="outline">
              <mat-label> Works Entry Created By</mat-label>
              <mat-select [(ngModel)]="indexModel.CreatedBy">
                <mat-option value="{{item.Value}}" *ngFor="let item of dDLList?.ddlCreatedByUserForProject">{{item.Text}} </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="row w-100 m-0">
              <div class="col l4 m6 s12">
                  <mat-label class="d-block mb-10 text-blue font-w-600">Get Work Type</mat-label>
                  <mat-radio-group class="radio_grp" aria-label="Select an option" [(ngModel)]="subSubCategory">
                    <mat-radio-button [value]="0" (change)="GetList($event.value)" class="mb-10">Non(Work Type not available)</mat-radio-button>
                    <mat-radio-button [value]="-1" (change)="GetList($event.value)">All(Available + Not Available)</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col l4 m6 s12">
                  <mat-label class="d-block mb-10 text-blue font-w-600">Shilanyas</mat-label>
                  <mat-radio-group class="radio_grp" aria-label="Select an option" [(ngModel)]="isShilanyas">
                    <mat-radio-button [value]="0" (change)="setShilanyas($event.value)" >Non(Shilanyas)</mat-radio-button>
                    <mat-radio-button [value]="1" (change)="setShilanyas($event.value)">Shilanyas</mat-radio-button>
                    <mat-radio-button [value]="-1" (change)="setShilanyas($event.value)">All</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col l3 xl3 m4 s12">
                  <mat-label class="mr-5">Get Active De-Active Data</mat-label>
                  <br/>
                  <mat-radio-group class="radio_grp" aria-label="Select an option" [(ngModel)]="indexModel.Status">
                    <mat-radio-button [value]="1" (change)="getActiveDeActiveData(1)" [checked]="indexModel.Status==1">Active
                    </mat-radio-button>
                    <mat-radio-button [value]="0" (change)="getActiveDeActiveData(0)">De-Active</mat-radio-button>
                    <mat-radio-button [value]="-1" (change)="getActiveDeActiveData(-1)">Both</mat-radio-button>
                  </mat-radio-group>
                </div>
                <div class="col l4 m6 s12 ">
                  <section class="example-full-width  checkbox-bx-custom checkbox-bx-custom-with-label mb-10" appearance="outline">
                    <mat-checkbox [(ngModel)]="indexModel.IsShowDataWithProgress" #IsShowDataWithProgress> Is Show Data With Progress</mat-checkbox>
                  </section>
                </div>
                <div class="col l4 m6 s12">
                  <mat-form-field class="example-full-width" appearance="outline">
                    <input matInput placeholder="Entry Number" [(ngModel)]="indexModel.Id" type="number"/>
                  </mat-form-field>
                </div>
          </div>





          <div class="col l12 m12 s12 text-center mb-20">
            <button (click)="searchClick();" class="btn btn_note btn_green" style="margin-right: 10px;">Search</button>
            <button (click)="clearClick();" class="btn btn_note btn_orange" style="margin-right: 10px;">Clear Search</button>

          </div>
        </div>

    <table mat-table [dataSource]="dataSource" matSort (matSortChange)="SortData($event)" class="mat-elevation-z8">
      <ng-container matColumnDef="index">
        <th mat-header-cell *matHeaderCellDef>S.no/Entry No</th>
        <td mat-cell *matCellDef="let element; let i = index" title={{(indexModel.Page-1)*indexModel.PageSize+(i+1)}}>
          {{ (indexModel.Page - 1) * indexModel.PageSize + (i + 1) }}/{{element.Id}}
        </td>
      </ng-container>
      <ng-container matColumnDef="ProjectSchemeName">
        <th mat-header-cell *matHeaderCellDef>

          <table class="table-in-data-head">
            <tbody>
              <tr>
                <td>Project/Scheme Name </td>
              </tr>
              <tr>
                <td>Department</td>
              </tr>
            </tbody>
          </table>

        </th>
        <td mat-cell *matCellDef="let element">

          <table class="table-in-data">
            <tbody>
              <tr>
                <td title={{element.ProjectSchemeName}}>{{ element.ProjectSchemeName }} </td>
              </tr>
              <tr *ngIf="element.DepartmentTitle">
                <td title={{element.DepartmentTitle}}>{{element.DepartmentTitle}}</td>
              </tr>
            </tbody>
          </table>

<!--
          {{ element.ProjectSchemeName }}
          <br>
          <span *ngIf="element.DepartmentTitle" style="color: #2922a2; font-weight: bold;">/{{element.DepartmentTitle}}</span> -->


        </td>
      </ng-container>
      <ng-container matColumnDef="ProjectSchemeDescription">
        <th mat-header-cell *matHeaderCellDef>


          <table class="table-in-data-head">
            <tbody>
              <tr>
                <td>Project/Scheme, Description </td>
              </tr>
              <tr>
                <td> Category</td>
              </tr>
              <tr>
                <td> Sub Category</td>
              </tr>
              <tr>
                <td>Work Type</td>
                  </tr>
                  <tr>
                <td>Status</td>
              </tr>
            </tbody>
          </table>

        </th>
        <td mat-cell *matCellDef="let element">
          <!-- {{ element.ProjectSchemeDescription }}
          <br>
          <span *ngIf="element.CategoryName" style="color: #2922a2; font-weight: bold;">/{{element.CategoryName}}</span>
          <br>
          <span *ngIf="element.SubCategoryName" style="color: #70116b; font-weight: bold;">/{{element.SubCategoryName}}</span>
          <br>
          <span *ngIf="element.SubSubCategoryName" style="color: #666d09; font-weight: bold;">/{{element.SubSubCategoryName}}</span>
          <br>
          <span *ngIf="element.StatusName" style="color: #0d4115; font-weight: bold;">/{{element.StatusName}}</span> -->


          <table class="table-in-data">
            <tbody>
                  <tr>
                <td title={{element.ProjectSchemeDescription}} >{{ element.ProjectSchemeDescription }}</td>
              </tr>
              <tr *ngIf="element.CategoryName" >
                <td title={{element.CategoryName}} >{{element.CategoryName}} </td>
              </tr>
              <tr *ngIf="element.SubCategoryName">
                <td title={{element.SubCategoryName}} >{{element.SubCategoryName}}</td>
              </tr>
              <tr *ngIf="element.SubSubCategoryName">
                <td title={{element.SubSubCategoryName}}>{{element.SubSubCategoryName}}</td>
              </tr>
              <tr *ngIf="element.StatusName">
                <td title={{element.StatusName}} >{{element.StatusName}}</td>
                  </tr>

            </tbody>
          </table>

        </td>
      </ng-container>


      <ng-container matColumnDef="ModifiedDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>

          <table class="table-in-data-head">
            <tbody>
              <tr>
                <td>Last Modified Date </td>
              </tr>
              <tr>
                <td>Created By</td>
              </tr>
              <tr>
                <td>Created Date</td>
              </tr>
              <tr>
                <td>Created User Contact No.</td>
              </tr>
            </tbody>
          </table>

        </th>
        <td mat-cell *matCellDef="let element" class="action-link toogle-btn">


          <table class="table-in-data">
            <tbody>
              <tr>
                <td> {{ element.ModifiedDate !=null ? (element.ModifiedDate| date: 'dd/MM/yyy , h:mm:ss a') :'--' }} </td>
              </tr>
              <tr *ngIf="element.createdByName">
                <td title="element.createdByName">{{element.createdByName}}</td>
              </tr>
              <tr *ngIf="element.CreatedDate">
                <td title={{element.CreatedDate}}>{{ element.CreatedDate| date: 'dd/MM/yyy , h:mm:ss a'}}</td>
              </tr>
              <tr *ngIf="element.CreatedUserContact">
                <td title={{element.CreatedUserContact}}>{{element.CreatedUserContact}}</td>
              </tr>
            </tbody>
          </table>


          <!-- {{ element.ModifiedDate !=null ? (element.ModifiedDate| date: 'dd/MM/yyy , h:mm:ss a') :'--' }}
          <br>
          <span *ngIf="element.createdByName" style="color: #2922a2; font-weight: bold;">/{{element.createdByName}}</span>
          <br>
          <span *ngIf="element.CreatedDate" style="color: #0d4115; font-weight: bold;">/{{ element.CreatedDate| date: 'dd/MM/yyy , h:mm:ss a'}}</span> -->


        </td>
      </ng-container>
      <ng-container matColumnDef="MLAConstituencyName">
        <th mat-header-cell *matHeaderCellDef>
          <table class="table-in-data-head">
            <tbody>
              <tr>
                <td> AC Name </td>
              </tr>
              <tr>
                <td>District </td>
              </tr>
              <tr>
                <td>Description</td>
              </tr>
              <tr>
                <td>Cost</td>
              </tr>
            </tbody>
          </table>

          </th>
        <td mat-cell *matCellDef="let element">
          <table class="table-in-data">
            <tbody>
              <tr>
                <td title="element.MLAConstituencyName"> {{ element.MLAConstituencyName }} </td>
              </tr>
              <tr>
                <td title="element.DistrictNames"> {{ element.DistrictNames }} </td>
              </tr>
              <tr *ngIf="element.ChildDescription" >
                <td title={{element.ChildDescription}}>{{element.ChildDescription}}</td>
              </tr>
              <tr *ngIf="element.Cost" >
                <td title={{element.Cost}}>{{element.Cost}}</td>
              </tr>
            </tbody>
          </table>
<!--
          {{ element.MLAConstituencyName }}
          <br>
          <span *ngIf="element.ChildDescription"  title={{element.ChildDescription}}>/{{element.ChildDescription}}</span> -->

        </td>
      </ng-container>
      <ng-container matColumnDef="IsActive">
        <th mat-header-cell *matHeaderCellDef> Active Status </th>
        <td mat-cell *matCellDef="let element" class="action-link toogle-btn">
          <a *ngIf="this.Permission.UpdatePageAccess" (click)="OnActiveStatus(element.Id)"
            title="Update Active Status">
            <mat-icon *ngIf="element.IsActive" style="cursor:pointer;color: #74cb74;">toggle_on</mat-icon>
            <mat-icon *ngIf="!element.IsActive" style="cursor:pointer;color: #ff7373;">toggle_off</mat-icon>
          </a>
          <a *ngIf="!this.Permission.UpdatePageAccess" title="Active Status">
            <mat-icon *ngIf="element.IsActive" style="cursor:pointer;color: #74cb74;">toggle_on</mat-icon>
            <mat-icon *ngIf="!element.IsActive" style="cursor:pointer;color: #ff7373;">toggle_off</mat-icon>
          </a>
        </td>
      </ng-container>

      <ng-container matColumnDef="Action">
        <th mat-header-cell *matHeaderCellDef>Action</th>
        <td mat-cell *matCellDef="let element" class="action-link">
          <a  routerLink="/master/projectmasteradd/{{ element.Id }}" title="Edit"
            class="btn_list" *ngIf="this.Permission.UpdatePageAccess">
            <mat-icon>edit</mat-icon>
          </a>
          <a *ngIf="this.Permission.DeletePageAccess" (click)="DeleteProjectBySuperAdmin(element.Id)" title="Delete" >
            <mat-icon>delete</mat-icon>
          </a>
          <a (click)="openDialog(element.Id)" title="Update Progress" *ngIf="Permission.Custome1PageAccess">
              <mat-icon>poll</mat-icon>
            </a>
            <a  (click)="DownloadJsonFile(element)" title="Down Json Format"  download="download.json">
              <mat-icon>download</mat-icon>
            </a>
            <a
            routerLink="/master/projectmasterdetail/{{ element.Id }}" title="Detail" class="btn_edit">
            <mat-icon>visibility</mat-icon>
          </a>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
      <tr mat-row *matRowDef="let row; columns: columnsToDisplay"></tr>
    </table>
    <mat-paginator #paginator [length]="totalRecords" [pageSize]="indexModel.PageSize"
      [pageSizeOptions]="[5, 10, 20, 50,totalRecords]" (page)="onPaginateChange($event)" showFirstLastButtons *ngIf="totalRecords!=0"> </mat-paginator>

  </div>
</div>
